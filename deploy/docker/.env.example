# ═══════════════════════════════════════════════════════════════════════
# Apollos AI — Docker Compose Environment Configuration
# ═══════════════════════════════════════════════════════════════════════
#
# Copy this file to .env and fill in the values:
#   cp .env.example .env
#
# Or use the setup script for guided configuration:
#   ./setup.sh
#
# This file is loaded via Docker Compose's env_file directive, injecting
# all variables into the container's process environment at startup.
#
# Full reference: docs/reference/environment-variables.md

# ─── Docker Compose Settings ──────────────────────────────────────────
# These control docker-compose behavior, not the app itself.

# App image tag (default: latest). Pin to a version for stability.
# IMAGE_TAG=latest
# IMAGE_TAG=v1.0.0

# Host port for direct access (bypassing Caddy). Default: 50080.
# HOST_PORT=50080

# Domain for Caddy reverse proxy (used in Caddyfile).
# Set to your FQDN for production, or localhost for development.
DOMAIN=localhost

# ─── SSL / Custom CA Certificates (optional) ─────────────────────────
# If your LLM provider uses a certificate signed by a private/enterprise CA
# (e.g., wildcard cert from DigiCert managed PKI), place the CA certificate
# chain (PEM format) in certs/ca/ and set the path below.
#
# Option A: Point Python to a specific CA bundle (recommended)
#   1. Place your CA chain PEM in: certs/ca/your-ca.pem
#   2. Uncomment: REQUESTS_CA_BUNDLE=/usr/local/share/ca-certificates/custom/your-ca.pem
#
# Option B: Disable SSL verification entirely (not recommended for production)
#   SSL_VERIFY=false
#
# REQUESTS_CA_BUNDLE=/usr/local/share/ca-certificates/custom/your-ca.pem
# SSL_CERT_FILE=/usr/local/share/ca-certificates/custom/your-ca.pem

# ─── Security (REQUIRED) ─────────────────────────────────────────────
# Generate with: python3 -c "import secrets; print(secrets.token_hex(32))"

# Flask session signing key. MUST be persistent across restarts.
FLASK_SECRET_KEY=

# Vault master key for encrypting secrets at rest (AES-256-GCM).
# Required for OIDC token cache, API key vault, and MCP credentials.
VAULT_MASTER_KEY=

# SSH password for the code execution container (used by both root and appuser).
# Auto-generated and persisted to .env by the container if unset.
# Generate with: python3 -c "import secrets, string; print(''.join(secrets.choice(string.ascii_letters + string.digits) for _ in range(32)))"
# ROOT_PASSWORD=

# HTTP password for Remote Function Calls between dev host and execution container.
# Generate with: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
# RFC_PASSWORD=

# ─── Admin Bootstrap ─────────────────────────────────────────────────
# Creates the initial admin account on first startup.

ADMIN_EMAIL=admin@example.com
ADMIN_PASSWORD=

# ─── API Keys (Provider Authentication) ──────────────────────────────
# At least one provider is required. Uncomment and set what you use.
# Primary pattern: API_KEY_{PROVIDER} (provider IDs from conf/model_providers.yaml)
# Alternative patterns also accepted: {PROVIDER}_API_KEY, {PROVIDER}_API_TOKEN.

# API_KEY_ANTHROPIC=sk-ant-...
# API_KEY_OPENAI=sk-...
# API_KEY_GOOGLE=...
# API_KEY_OPENROUTER=sk-or-...
# API_KEY_DEEPSEEK=...
# API_KEY_GROQ=gsk_...
# API_KEY_MISTRAL=...
# API_KEY_XAI=...
# API_KEY_HUGGINGFACE=hf_...
# API_KEY_AZURE=
# API_KEY_BEDROCK=
# API_KEY_SAMBANOVA=
# API_KEY_LITELLM_PROXY=
# API_KEY_MOONSHOT=
# API_KEY_COMETAPI=
# API_KEY_GITHUB_COPILOT=
# API_KEY_OLLAMA=
# API_KEY_LM_STUDIO=
# API_KEY_A0_VENICE=
# API_KEY_VENICE=
# API_KEY_ZAI=
# API_KEY_ZAI_CODING=
# API_KEY_OTHER=

# ─── API Base URLs (Provider Endpoints) ──────────────────────────────
# Override the default base URL for a provider.
# Pattern: {PROVIDER}_API_BASE
# Precedence: UI Settings > Env var > YAML default

# LITELLM_PROXY_API_BASE=http://localhost:4000/v1
# OLLAMA_API_BASE=http://localhost:11434

# ─── Model Configuration (A0_SET_*) ─────────────────────────────────
# Any UI setting can be overridden here with the A0_SET_ prefix.
# Case-insensitive. Type is auto-coerced to match the setting default.
# Full reference (61+ settings): docs/reference/environment-variables.md

# --- Chat Model ---
# A0_SET_CHAT_MODEL_PROVIDER=litellm_proxy
# A0_SET_CHAT_MODEL_NAME=gpt-5-mini
# A0_SET_CHAT_MODEL_CTX_LENGTH=128000
# A0_SET_CHAT_MODEL_KWARGS={"temperature": "0"}

# --- Utility Model ---
# A0_SET_UTIL_MODEL_PROVIDER=litellm_proxy
# A0_SET_UTIL_MODEL_NAME=gpt-5-mini

# --- Embedding Model ---
# A0_SET_EMBED_MODEL_PROVIDER=huggingface
# A0_SET_EMBED_MODEL_NAME=sentence-transformers/all-MiniLM-L6-v2

# --- Browser Model ---
# A0_SET_BROWSER_MODEL_PROVIDER=litellm_proxy
# A0_SET_BROWSER_MODEL_NAME=gpt-5-mini

# --- Memory & Recall ---
# A0_SET_MEMORY_RECALL_ENABLED=true
# A0_SET_MEMORY_RECALL_INTERVAL=3
# A0_SET_MEMORY_RECALL_SIMILARITY_THRESHOLD=0.7
# A0_SET_MEMORY_MEMORIZE_ENABLED=true

# --- Agent & Workspace ---
# A0_SET_AGENT_PROFILE=apollos
# A0_SET_AGENT_MEMORY_SUBDIR=default
# A0_SET_WORKDIR_PATH=usr/workdir

# --- Code Execution (RFC) ---
# A0_SET_RFC_AUTO_DOCKER=true
# A0_SET_RFC_URL=localhost
# A0_SET_RFC_PORT_HTTP=55080
# A0_SET_RFC_PORT_SSH=55022
# A0_SET_SHELL_INTERFACE=ssh

# --- Platform Integrations ---
# Master toggle — must be true for any webhook handler to process events.
# A0_SET_INTEGRATIONS_ENABLED=false

# Slack: Found in Slack App > Basic Information > Signing Secret
# A0_SET_SLACK_SIGNING_SECRET=
# Slack: Found in Slack App > OAuth & Permissions > Bot User OAuth Token
# A0_SET_SLACK_BOT_TOKEN=xoxb-...

# GitHub: Set in GitHub App > Webhook > Secret
# A0_SET_GITHUB_WEBHOOK_SECRET=
# GitHub: Shown on the GitHub App settings page
# A0_SET_GITHUB_APP_ID=

# Jira: Shared secret passed as ?secret= query parameter in webhook URL
# A0_SET_JIRA_WEBHOOK_SECRET=
# Jira: Your Atlassian Cloud site URL (for API callbacks)
# A0_SET_JIRA_SITE_URL=https://your-org.atlassian.net

# --- MCP & A2A ---
# A0_SET_MCP_SERVER_ENABLED=false
# A0_SET_A2A_SERVER_ENABLED=false
# Generate with: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
# A2A_TOKEN=

# ─── Authentication — Legacy Single-User (simple) ───────────────────
# Basic username/password protection. Use for single-user deployments.
# For multi-user with SSO, use the OIDC section below instead.

# AUTH_LOGIN=admin
# AUTH_PASSWORD=changeme

# ─── Authentication — OIDC / Entra ID SSO (optional) ────────────────
# Microsoft Entra ID (Azure AD) single sign-on.
# All three are required to enable SSO (the login page will show an SSO button).
# Requires VAULT_MASTER_KEY to be set.

# OIDC_TENANT_ID=
# OIDC_CLIENT_ID=
# OIDC_CLIENT_SECRET=
# Explicit callback URL. Set to your production URL behind Caddy.
# OIDC_REDIRECT_URI=https://your-domain.com/auth/callback

# Auto-assign SSO users to default org/team when they have no EntraID group mappings.
# Set to "false" in production to require explicit admin-managed group mappings.
# A0_SET_SSO_AUTO_ASSIGN=true

# Default role for auto-assigned SSO users (member, viewer).
# A0_SET_SSO_DEFAULT_ROLE=member

# Bootstrap EntraID group-to-org/team mappings at startup (alternative to admin API).
# Format: entra_group_id:org_slug:team_slug:role (semicolon-separated entries).
# A0_SET_SSO_GROUP_MAPPINGS=aad-guid-1:default:default:member;aad-guid-2:default:default:team_lead

# ─── MCP Server OAuth (optional) ────────────────────────────────────
# OAuth for IDE clients connecting via MCP protocol.
# Separate app registration from OIDC SSO.

# MCP_AZURE_CLIENT_ID=
# MCP_AZURE_CLIENT_SECRET=
# MCP_AZURE_TENANT_ID=
# MCP_AZURE_IDENTIFIER_URI=
# MCP_AZURE_REDIRECT_URIS=
# Generate with: python3 -c "import secrets; print(secrets.token_urlsafe(48))"
# MCP_AZURE_JWT_SIGNING_KEY=

# Public base URL — used by MCP server OAuth (inbound IDE connections)
# and MCP client OAuth (outbound connections to external MCP services).
# Both must match your publicly reachable URL when deployed behind Caddy.
# MCP_SERVER_BASE_URL=https://your-domain.com
# APP_BASE_URL=https://your-domain.com

# ─── PostgreSQL (--profile postgres) ─────────────────────────────────
# Only needed when running with: docker compose --profile postgres up -d
# Uncomment AUTH_DATABASE_URL to switch from SQLite to PostgreSQL.

# POSTGRES_PASSWORD=
# Note: ${POSTGRES_PASSWORD} is interpolated by python-dotenv at app startup.
# It resolves correctly as long as POSTGRES_PASSWORD is defined above this line.
# AUTH_DATABASE_URL=postgresql://apollos:${POSTGRES_PASSWORD}@postgres:5432/apollos_auth

# ─── Server & Networking ─────────────────────────────────────────────
# Inside the container the app listens on port 80 by default.
# These overrides are primarily for non-Docker development.

# CORS origins — required when accessing via a custom domain through Caddy.
# Comma-separated list of allowed origins (scheme + host + optional port).
# CORS_ALLOWED_ORIGINS=https://your-domain.com

# CSRF allowed origins — auto-populated on first visit when login is disabled.
# When login IS enabled (AUTH_LOGIN or OIDC), or running locally this is not needed.
# ALLOWED_ORIGINS=https://your-domain.com

# Mark session cookie as Secure (recommended when serving over HTTPS via Caddy).
# SESSION_COOKIE_SECURE=true

# WEB_UI_HOST=localhost
# WEB_UI_PORT=5000
# TUNNEL_API_PORT=0

# ─── Branding (optional) ────────────────────────────────────────────

# BRAND_NAME=Apollos AI
# BRAND_SLUG=apollos-ai
# BRAND_URL=https://apollos.ai
# BRAND_GITHUB_URL=https://github.com/jrmatherly/apollos-ai
# BRAND_UPDATE_CHECK_URL=https://api.github.com/repos/jrmatherly/apollos-ai/releases/latest

# ─── Debug & Development ─────────────────────────────────────────────

# A0_WS_DEBUG=0
# A0_SET_UVICORN_ACCESS_LOGS_ENABLED=false

# Max upload/form size in bytes. Default: 5 GB (5368709120).
# FLASK_MAX_CONTENT_LENGTH=5368709120
# FLASK_MAX_FORM_MEMORY_SIZE=5368709120
