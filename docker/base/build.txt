# Base image build reference (Kali + system packages, amd64)
#
# Prefer mise tasks â€” they handle platform flags and tagging automatically:
#   mise run docker:build:base     # Build locally
#   mise run docker:push:base      # Build + push to GHCR
#
# CI: .github/workflows/docker-base.yml builds on docker/base/** changes.

# Manual local build (from docker/base/):
docker build -t apollos-ai-base:local \
  --platform linux/amd64 \
  --build-arg CACHE_DATE=$(date +%Y-%m-%d:%H:%M:%S) .

# Manual local build without cache:
docker build -t apollos-ai-base:local \
  --platform linux/amd64 --no-cache .

# Manual GHCR push (authenticate first: docker login ghcr.io):
docker buildx build -t ghcr.io/jrmatherly/apollos-ai-base:latest \
  --platform linux/amd64 --push \
  --build-arg CACHE_DATE=$(date +%Y-%m-%d:%H:%M:%S) .

# Verbose output:
# Append --progress=plain to any build command above.
